{"ast":null,"code":"const jwt = require('jsonwebtoken');\nconst User = require('../models/user');\nrequire('dotenv').config();\n\n//creating tokens(cookies) and verifying it\n//copied from lesson*\n\nconst createToken = id => {\n  return jwt.sign({\n    id\n  }, process.env.JWT_SECRET, {\n    expiresIn: 3 * 24 * 60 * 60\n  });\n};\nconst requireAuth = (req, res, next) => {\n  const token = req.cookies.jwt;\n  if (token) {\n    jwt.verify(token, process.env.JWT_SECRET, (err, decodedToken) => {\n      if (err) {\n        console.log(err.message);\n        res.redirect('/login');\n      } else {\n        console.log(decodedToken);\n        next();\n      }\n    });\n  } else {\n    console.log(\"token undefined\");\n    res.redirect('/login');\n  }\n};\nmodule.exports = {\n  createToken,\n  requireAuth\n};","map":{"version":3,"names":["jwt","require","User","config","createToken","id","sign","process","env","JWT_SECRET","expiresIn","requireAuth","req","res","next","token","cookies","verify","err","decodedToken","console","log","message","redirect","module","exports"],"sources":["/Users/newmacmini/Downloads/GoJobAssignment/COMP229-GoJob/src/utils/utils.js"],"sourcesContent":["const jwt = require('jsonwebtoken');\nconst User = require('../models/user');\nrequire('dotenv').config();\n\n\n\n//creating tokens(cookies) and verifying it\n//copied from lesson*\n\nconst createToken = (id) => {\n    return jwt.sign({id}, process.env.JWT_SECRET, {expiresIn: 3 * 24 * 60 * 60} );\n }\n \n const requireAuth = (req, res, next) => {\n    const token = req.cookies.jwt;\n    if(token)\n    {\n       jwt.verify(token, process.env.JWT_SECRET, (err, decodedToken)=> {\n          if(err)\n          {\n             console.log(err.message)\n             res.redirect('/login')\n          }\n          else\n          {\n             console.log(decodedToken)\n             next()\n          }\n \n       })\n \n    }\n    else{\n       console.log(\"token undefined\")\n       res.redirect('/login')\n    }\n }\n\n\n module.exports = { createToken, requireAuth}"],"mappings":"AAAA,MAAMA,GAAG,GAAGC,OAAO,CAAC,cAAc,CAAC;AACnC,MAAMC,IAAI,GAAGD,OAAO,CAAC,gBAAgB,CAAC;AACtCA,OAAO,CAAC,QAAQ,CAAC,CAACE,MAAM,CAAC,CAAC;;AAI1B;AACA;;AAEA,MAAMC,WAAW,GAAIC,EAAE,IAAK;EACxB,OAAOL,GAAG,CAACM,IAAI,CAAC;IAACD;EAAE,CAAC,EAAEE,OAAO,CAACC,GAAG,CAACC,UAAU,EAAE;IAACC,SAAS,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG;EAAE,CAAE,CAAC;AAChF,CAAC;AAED,MAAMC,WAAW,GAAGA,CAACC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;EACrC,MAAMC,KAAK,GAAGH,GAAG,CAACI,OAAO,CAAChB,GAAG;EAC7B,IAAGe,KAAK,EACR;IACGf,GAAG,CAACiB,MAAM,CAACF,KAAK,EAAER,OAAO,CAACC,GAAG,CAACC,UAAU,EAAE,CAACS,GAAG,EAAEC,YAAY,KAAI;MAC7D,IAAGD,GAAG,EACN;QACGE,OAAO,CAACC,GAAG,CAACH,GAAG,CAACI,OAAO,CAAC;QACxBT,GAAG,CAACU,QAAQ,CAAC,QAAQ,CAAC;MACzB,CAAC,MAED;QACGH,OAAO,CAACC,GAAG,CAACF,YAAY,CAAC;QACzBL,IAAI,CAAC,CAAC;MACT;IAEH,CAAC,CAAC;EAEL,CAAC,MACG;IACDM,OAAO,CAACC,GAAG,CAAC,iBAAiB,CAAC;IAC9BR,GAAG,CAACU,QAAQ,CAAC,QAAQ,CAAC;EACzB;AACH,CAAC;AAGDC,MAAM,CAACC,OAAO,GAAG;EAAErB,WAAW;EAAEO;AAAW,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}